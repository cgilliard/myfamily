# Executables
SHELL := /bin/bash
CC=cc
MAKE=make

# FLags
CC_FLAGS=-D_GNU_SOURCE -Wno-ignored-attributes -Wno-int-to-pointer-cast
CRITERION_INCLUDE=-IREPLACE_CRITERION_INCLUDE
CRITERION_LIB=-LREPLACE_CRITERION_LIB
CC_TEST_FLAGS=-D_GNU_SOURCE -Wno-ignored-attributes -Wno-int-to-pointer-cast -lcriterion $(CRITERION_INCLUDE) $(CRITERION_LIB)
ifeq ($(shell $(CC) -dM -E - < /dev/null | grep '__clang__'),)
    # If GCC is detected
    CC_FLAGS += -Werror=discarded-qualifiers
    CC_TEST_FLAGS += -Werror=discarded-qualifiers
else
    # If Clang is detected
    CC_FLAGS += -Werror=incompatible-pointer-types-discards-qualifiers
    CC_TEST_FLAGS += -Werror=incompatible-pointer-types-discards-qualifiers
endif
RELEASE_FLAGS=-O3 -flto
TEST_FLAGS=-g -Og -DTEST
SAN_FLAGS=-g -Og -fsanitize=undefined -fsanitize=address -DTEST
COVERAGE_FLAGS=--coverage -DTEST

# Install directory
INSTALL_DIR=/usr/local/bin

# Object directories
ALL_OBJS=main/*.o toml/*.o core/*.o
SUBDIRS := main toml core
SUBDIRS_RELEASE := $(SUBDIRS)
HEADERS := $(wildcard main/*.h) \
           $(wildcard toml/*.h) \
           $(wildcard core/*.h)
